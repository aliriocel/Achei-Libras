{"version":3,"sources":["./src/app/chat/chat.page.html","./src/app/chat/chat-routing.module.ts","./src/app/chat/chat.module.ts","./src/app/chat/chat.page.scss","./src/app/chat/chat.page.ts","./src/app/services/chat.service.ts"],"names":[],"mappings":"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","file":"chat-chat-module-es2015.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar color=\\\"primary\\\">\\n    <ion-title>Achei Libras Chat</ion-title>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n \\n<ion-content class=\\\"ion-padding\\\">\\n \\n  <ion-grid>\\n    <ion-row *ngFor=\\\"let message of messages | async\\\">\\n      <ion-col size=\\\"9\\\" class=\\\"message\\\"\\n        [offset]=\\\"message.myMsg ? 3 : 0\\\"\\n        [ngClass]=\\\"{ 'my-message': message.myMsg, 'other-message': !message.myMsg }\\\">\\n        <b>{{ message.fromName }}</b><br>\\n        <span>{{ message.msg }}\\n        </span>\\n        <div class=\\\"time ion-text-right\\\"><br>{{ message.createdAt?.toMillis() | date:'short' }}</div>\\n      </ion-col>\\n    </ion-row>\\n  </ion-grid>\\n \\n</ion-content>\\n \\n<ion-footer>\\n  <ion-toolbar color=\\\"light\\\">\\n    <ion-row class=\\\"ion-align-items-center\\\">\\n      <ion-col size=\\\"10\\\">\\n        <ion-textarea autoGrow=\\\"true\\\" class=\\\"message-input\\\" rows=\\\"1\\\" maxLength=\\\"500\\\" [(ngModel)]=\\\"newMsg\\\" >\\n        </ion-textarea>\\n      </ion-col>\\n      <ion-col size=\\\"2\\\">\\n        <ion-button expand=\\\"block\\\" fill=\\\"clear\\\" color=\\\"primary\\\" [disabled]=\\\"newMsg === ''\\\"\\n          class=\\\"msg-btn\\\" (click)=\\\"sendMessage()\\\">\\n          <ion-icon name=\\\"send\\\" slot=\\\"icon-only\\\"></ion-icon>\\n        </ion-button>\\n      </ion-col>\\n    </ion-row>\\n  </ion-toolbar>\\n</ion-footer>\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ChatPage } from './chat.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ChatPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ChatPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ChatPageRoutingModule } from './chat-routing.module';\n\nimport { ChatPage } from './chat.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ChatPageRoutingModule\n  ],\n  declarations: [ChatPage]\n})\nexport class ChatPageModule {}\n","export default \".message-input {\\n  width: 100%;\\n  border: 1px solid var(--ion-color-medium);\\n  border-radius: 6px;\\n  background: #fff;\\n  resize: none;\\n  margin-top: 0px;\\n  --padding-start: 8px;\\n}\\n\\n.message {\\n  padding: 10px !important;\\n  border-radius: 10px !important;\\n  margin-bottom: 4px !important;\\n  white-space: pre-wrap;\\n}\\n\\n.my-message {\\n  background: var(--ion-color-tertiary);\\n  color: #fff;\\n}\\n\\n.other-message {\\n  background: var(--ion-color-secondary);\\n  color: #fff;\\n}\\n\\n.time {\\n  color: #dfdfdf;\\n  float: right;\\n  font-size: small;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY2hhdC9jaGF0LnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLFdBQUE7RUFDQSx5Q0FBQTtFQUNBLGtCQUFBO0VBQ0EsZ0JBQUE7RUFDQSxZQUFBO0VBQ0EsZUFBQTtFQUNBLG9CQUFBO0FBQ0o7O0FBRUE7RUFDSSx3QkFBQTtFQUNBLDhCQUFBO0VBQ0EsNkJBQUE7RUFDQSxxQkFBQTtBQUNKOztBQUVBO0VBQ0kscUNBQUE7RUFDQSxXQUFBO0FBQ0o7O0FBRUE7RUFDSSxzQ0FBQTtFQUNBLFdBQUE7QUFDSjs7QUFFQTtFQUNJLGNBQUE7RUFDQSxZQUFBO0VBQ0EsZ0JBQUE7QUFDSiIsImZpbGUiOiJzcmMvYXBwL2NoYXQvY2hhdC5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIubWVzc2FnZS1pbnB1dCB7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0taW9uLWNvbG9yLW1lZGl1bSk7XG4gICAgYm9yZGVyLXJhZGl1czogNnB4O1xuICAgIGJhY2tncm91bmQ6ICNmZmY7XG4gICAgcmVzaXplOiBub25lO1xuICAgIG1hcmdpbi10b3A6IDBweDtcbiAgICAtLXBhZGRpbmctc3RhcnQ6IDhweDtcbn1cbiBcbi5tZXNzYWdlIHtcbiAgICBwYWRkaW5nOiAxMHB4ICFpbXBvcnRhbnQ7XG4gICAgYm9yZGVyLXJhZGl1czogMTBweCAhaW1wb3J0YW50O1xuICAgIG1hcmdpbi1ib3R0b206IDRweCAhaW1wb3J0YW50O1xuICAgIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDtcbn1cbiBcbi5teS1tZXNzYWdlIHtcbiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1pb24tY29sb3ItdGVydGlhcnkpO1xuICAgIGNvbG9yOiAjZmZmO1xufVxuIFxuLm90aGVyLW1lc3NhZ2Uge1xuICAgIGJhY2tncm91bmQ6IHZhcigtLWlvbi1jb2xvci1zZWNvbmRhcnkpO1xuICAgIGNvbG9yOiAjZmZmO1xufVxuIFxuLnRpbWUge1xuICAgIGNvbG9yOiAjZGZkZmRmO1xuICAgIGZsb2F0OiByaWdodDtcbiAgICBmb250LXNpemU6IHNtYWxsO1xufSJdfQ== */\";","import { Component, OnInit, ViewChild } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { IonContent } from '@ionic/angular';\nimport { Observable } from 'rxjs';\nimport { ChatService, Message } from '../services/chat.service';\n\n@Component({\n  selector: 'app-chat',\n  templateUrl: './chat.page.html',\n  styleUrls: ['./chat.page.scss'],\n})\nexport class ChatPage implements OnInit {\n\n  @ViewChild(IonContent) content: IonContent;\n\n  messages: Observable<Message[]>;\n  newMsg = '';\n\n  constructor(private chatService: ChatService,\n    private router: Router\n  ) { }\n\n  ngOnInit() {\n\n    this.messages = this.chatService.getChatMessage();\n  }\n\n  sendMessage() {\n    this.chatService.addChatMessage(this.newMsg).then(() => {\n      this.newMsg = '';\n      this.content.scrollToBottom();\n    });\n  }\n\n  singOut(){\n    this.chatService.signOut().then(()=>{\n      this.router.navigateByUrl('/', { replaceUrl: true});\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { AngularFirestore } from '@angular/fire/firestore';\nimport * as firebase from 'firebase/app';\nimport { Observable } from 'rxjs';\nimport { switchMap, map } from 'rxjs/operators';\n\nexport interface User {\n  uid: string;\n  email: string;\n}\n\n\nexport interface Message {\n  createdAt: firebase.firestore.FieldValue;\n  id: string;\n  from: string;\n  msg: string;\n  fromName: string;\n  myMsg: boolean;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ChatService {\n  currentuser: User = null;\n\n  constructor(private afAuth: AngularFireAuth,\n    private afs: AngularFirestore) {\n\n    this.afAuth.onAuthStateChanged(user => {\n      console.log('Changed: ', user);\n      this.currentuser = user;\n    });\n  }\n\n  async signUp({ email, password }) {\n    const credential = await this.afAuth.createUserWithEmailAndPassword\n      (email, password);\n\n    console.log('result: ', credential);\n    const uid = credential.user.uid;\n\n    return this.afs.doc(\n      `users/${uid}`).set({\n        uid,\n        email: credential.user.email,\n      })\n  }\n\n\n  signIn({ email, password }) {\n    return this.afAuth.signInWithEmailAndPassword\n      (email, password);\n  }\n\n  signOut() {\n    return this.afAuth.signOut();\n  }\n\n  addChatMessage(msg) {\n    return this.afs.collection('messages').add({\n      msg,\n      from: this.currentuser.uid,\n      createdAt: firebase.firestore.FieldValue.serverTimestamp()\n    });\n  }\n\n  getChatMessage() {\n    let users = [];\n\n    return this.getUsers().pipe(\n      switchMap(res => {\n        users = res;\n        console.log('all users', users);\n        return this.afs.collection('messages', ref => ref.orderBy('createdAt')).valueChanges({ idField: 'id' }) as Observable<Message[]>\n      }),\n      map(messages => {\n        for (let m of messages) {\n          m.fromName = this.getUsersForMsg(m.from, users);\n          m.myMsg = this.currentuser.uid === m.from;\n        }\n        console.log('all messages: ', messages)\n\n        return messages;\n      })\n    )\n  }\n\n  getUsers() {\n    return this.afs.collection('cadastros_de_clientes').valueChanges({ idField: 'uid' }) as Observable<User[]>\n  }\n\n  getUsersForMsg(msgFromId, users: User[]): string {\n    for (let usr of users) {\n      if (usr.uid == msgFromId) {\n        return usr.email;\n      }\n    }\n\n    return 'Você';\n  }\n}\n"],"sourceRoot":"webpack:///"}